### 📝 CORS와 Preflight의 개념

<details>
<summary>CORS란 무엇인지 설명해주세요.</summary>
</br>
CORS란 Cross Origin Resource Sharing의 약자로, 교차 출처 리소스 공유라고 부릅니다. </br> 2009년에 HTML5 표준으로 채택된 프로토콜이며, SOP에 의해 제한된 교차 출처 간 리소스 공유를 허용하기 위한 방법입니다. </br> 애플리케이션의 요구 사항이 복잡해지면서, 다른 도메인의 리소스를 활용하는 경우가 많아졌기 때문에 등장한 프로토콜로, 서버에서 CORS 관련 헤더를 설정하여 다른 도메인에서의 리소스 요청을 허용할 수 있습니다. </br> CORS에러는 CORS 헤더를 적절히 설정하지 않은 상태에서 교차 출처 리소스를 요청하는 경우 발생할 수 있습니다. </br>

CORS란 다른 웹사이트 주소에서 정보를 요청할 때 허락받는 시스템. 원래는 보안 때문에 "다른 사이트 거 가져오지마!"라는 규칙이 있었지만 요즘은 API처럼 다른 도메인에서 정보 가져올 일이 많기때문에 서버가 "괜찮아, 가져가도 돼"라고 허락해주는 것이 CORS임. 허락을 해주지 않으면 브라우저가 막음 -> CORS 에러

- 프로토콜?  
서버와 브라우저가 서로 어떻게 대화할지 약속한 규칙 </br>
데이터를 어떻게 주고받을지 정한 **통신 방식의 규칙** 
예를 들어 “너 파일 줄게”, “이미지 요청할게” 이런거를 할 때의 규칙 </br>
CORS는 그 규칙 중 하나 </br>

- 도메인?  
웹사이트 주소 </br>
http:// => 보통 웹사이트 </br>
https:// => 보안이 적용된 웹사이트 </br>
다른 도메인에서 요청한다 ⇒ A라는 웹사이트가 B라는 웹사이트에 있는 파일(리소스)를 가져오려고 한다. </br>
이걸 막 하면 보안 문제가 생기니까 서버에서 내 자료를 다른 사이트에서도 써도 돼요라는 허락(CORS 허용)을 해줘야함. </br>

- 헤더? </br>
요청하거나 응답할 때 같이 보내는 **메모지** 같은 역할 </br>
이건 "JSON"이에요, 이건 다른 사이트가 요청했어요. 허락했어요 같은 **작은 설명서** </br></br>

</details>

<details>
<summary>SOP란 무엇인지 설명해주세요.</summary>
</br>
Same Origin Policy의 약자로, 동일 출처 정책을 의미합니다. </br> 1990년대 후반에 등장한 보안 정책으로, 현재 출처와 동일한 출처의 리소스만 접근할 수 있도록 하는 정책입니다. </br> 여기서 동일 출처란, 도메인과 프로토콜, 포트 번호가 모두 같은 경우를 의미하며, 하나라도 다를 경우 동일 출처 정책에 의해 리소스 접근이 제한됩니다. </br></br>

- 포트 번호? </br>
컴퓨터가 통신하는 문(문 번호) </br>
서버가 어떤 문을 통해 데이터를 주고받을지 지정하는 번호 </br>
예: https://www.example.com → 내부적으로는 :443으로 접속함 </br></br>

</details>

<details>
<summary> SOP가 없을 경우 가능한 보안 취약점은 무엇인가요? </summary>
</br>
사용자 인증 정보에 해당하는 세션 ID 같은 정보들이 쿠키에 포함되어 있을 수 있기 때문에 이 세션 정보를 탈취하여 Cross Site Scripting 혹은, CSRF와 같은 해킹 공격에 이용할 수 있습니다. </br> SOP 정책을 통해 리소스를 다른 도메인에서 접근하지 못하도록 제한한다면, 이러한 해킹 공격을 어느 정도 완화할 수 있습니다. </br> </br>

- 세션 ID? </br>
로그인한 사용자를 기억하기 위한 번호표.  </br>
다른 페이지로 넘어가도 서버는 세션 ID라는 고유 번호를 만들어서 로그인했다라는 것을 서버가 알아보는 것.  </br>
즉, 로그인 상태를 유지하게 해주는 열쇠 </br>

- 쿠키? </br>
브라우저가 서버로부터 받은 세션 ID같은 것을 쿠키에 저장.  </br>
다음 요청 때 해당 쿠키를 자동으로 같이 보냄 -> 서버는 "너구나!"라고 인식 </br>
쿠키는 로그인 상태, 최근 본 상품, 설정 같은 것을 저장할 때도 사용됨 </br>
=> 세션ID (열쇠), 쿠키 (그 열쇠를 담아놓은 주머니) </br>

- XSS (Cross Site Scripting)?  </br>
사이트에 악성 스크립트를 심는 해킹 방법 </br>
사용자의 브라우저 정보를 해커가 탈취할 수 있게 만든는 위험한 공격 </br>

- CSRF (Cross Site Request Forgery)? </br>
내가 의도하지 않은 요청이 "내 계정"으로 날아가는 해킹 </br>
신뢰된 사용자의 인증정보를 악용하여 공격하는 방식 </br></br>

</details>

<details>
<summary> CORS 프로토콜이 동작하는 원리를 설명해주세요. </summary>
</br>
서버는 응답 처리 코드에서 CORS 관련 헤더를 설정할 수 있습니다. </br>
이 헤더를 통해 요청을 허용할 도메인과, HTTP 메서드, 그리고 요청 헤더의 종류를 정의할 수 있습니다. </br> 이후, 브라우저에서 서버로 리소스를 요청할 때, 이 헤더에 설정한 정보와 일치하지 않는다면, 브라우저에서 CORS에러가 발생하는 것입니다. </br> CORS 프로토콜 스펙에서 정의한 비교적 보안적으로 민감하지 않다고 판단되는 요청들이 있는데, 이를 단순 요청이라고 칭하며, 이 요청을 제외한 CORS 요청에는 실제 요청을 전송하기 전, 요청 허가를 위한 preflight 요청이 발생할 수 있습니다.</br></br>

</details>

<details>
<summary> Preflight 요청이란 무엇인지 설명해주세요. </summary>
</br>
preflight 요청은 보안적으로 민감한 CORS 요청에 대해, 요청이 가능한지를 먼저 확인하는 과정입니다.</br> 브라우저에서 자동으로 실행되는 요청으로, OPTIONS 메서드를 사용하며, 서버에서 설정한 CORS 관련 설정들을 Header 값으로 확인할 수 있습니다.</br> 이 과정을 통해, 허용되지 않는 요청에 대한 처리 부하를 낮출 수 있습니다. 즉 Preflight는 브라우저 성능 최적화용!</br></br>
</details>

<details>
<summary> 모든 CORS 프로토콜마다 Preflight 요청이 일어나나요?</summary>
</br>
보안적으로 민감하지 않은 단순 요청이거나, 이전에 응답받은 Preflight 응답이 캐싱되어 있는 경우 Preflight 요청이 일어나지 않습니다.</br> 브라우저에서 자동으로 실행되는 요청으로, OPTIONS 메서드를 사용하며, 서버에서 Access-Control-Max-Age라는 헤더 값을 초 단위로 설정할 수 있고, 이전 요청의 응답값이 아직 캐싱되어 있다면, 같은 요청에 대해서는 Preflight 요청이 일어나지 않습니다.</br> </br>

- 캐싱?   
자주 사용하는 데이터를 임시로 저장해 두고, 다음에 더 빠르게 사용하려는 것. </br>
웹에서는 서버에 매번 요청하지 않고, 이전에 받아온 응답 데이터를 잠깐 저장해두는 방식</br>
- OPTIONS 메서드란?  
브라우저가 먼저 "이 요청 해도 돼?"하고 서버에게 허락을 구하는 HTTP 메서드. </br>
Preflight 요청은 실제 요청 전에 OPTIONS 메서드로 먼저 날아감. </br>
- Access-Control-Max-Age  
Preflight 응답을 얼마나 오래 캐시할지(저장할지)정하는 시간.</br>
서버가 설정한 시간에 따라, 브라우저는 해당 시간 동안 Preflight 요청을 생략함. </br>
이 설정이 없다면, 브라우저는 매번 OPTIONS 요청을 보내야 해서 성능이 떨어짐. </br></br>

</details>

<details>
<summary> 단순 요청이 무엇인지 설명해주세요. </summary>
</br>
요청의 메서드가 GET, HEAD, POST 중 하나이며, 헤더와 Content-Type이 CORS프로토콜에서 지정한 값인 경우가 단순 요청에 해당합니다.</br> 이 경우는 Preflight 과정을 통한 권한 조회 과정 없이 CORS 요청이 가능합니다. </br></br>

- HEAD?  
  GET 요청처럼 정보를 요청하지만, 헤더만 받고, 실제 내용(body)는 받지 않는 요청 방식.  
  언제 사용? 파일 용량, 수정 시간 같은 메타 정보만 필요할 때  
  ex. 이미지 용량 확인, 웹 페이지 존재 여부 검사 등  

- Content-Type이란?  
  서버나 클라이언트가 보내는 데이터가 어떤 형식인지 알려주는 '데이터 설명서'



</details>